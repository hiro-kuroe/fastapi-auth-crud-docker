# FastAPI JWT 認証トラブル 初動チェックリスト

本チェックリストは、
「/token は通るのに /me が 401 / 403 になる」
といった認証トラブル発生時の **初動切り分け** を目的としています。

実装例や最終的な修正コードは含みません。


① トークン自体は正しく発行されているか

/token のレスポンスに access_token は含まれているか

sub に想定したユーザー識別子が入っているか

② SECRET_KEY は一貫しているか

.env / 環境変数 / Docker 設定で値が分岐していないか

ローカルとコンテナで同一か

再起動や再ビルド時にランダム生成されていないか

③ トークン生成と検証で同じ設定を使っているか

ALGORITHM が一致しているか

有効期限の扱いがズレていないか

④ 認証処理は FastAPI 側が責務を持っているか

他フレームワークやミドルウェアで上書きされていないか

ヘッダが途中で欠落していないか

⑤ 「正しく壊れている」可能性はないか

有効期限切れ

ユーザー無効化

意図した 401 / 403 かどうか

```markdown
この時点で原因が特定できない場合、
構成全体を含めた整理が必要になります。